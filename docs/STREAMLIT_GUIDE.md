# Streamlitアプリケーションガイド

## 概要

CareerNavigatorのStreamlitアプリケーションは、因果推論とAIを活用したブラウザベースのインタラクティブなキャリア支援システムです。

**主な機能:**
- ✅ 6種類のCSVファイルアップロード（データ読み込み）
- ✅ 因果推論ベースのスキル推薦
- ✅ 従業員向けキャリアダッシュボード
- ✅ スマートロードマップ（ガントチャート）
- ✅ キャリアパス比較機能
- ✅ インタラクティブな因果グラフ可視化

## 起動方法

### 1. 依存関係のインストール

```bash
cd CareerNavigator
uv sync
```

### 2. Streamlitアプリの起動

```bash
uv run streamlit run streamlit_app.py
```

ブラウザが自動的に開き、`http://localhost:8501` でアプリケーションが表示されます。

### 3. ポート変更（オプション）

```bash
uv run streamlit run streamlit_app.py --server.port 8502
```

## アプリケーション構成

CareerNavigatorは以下の3つのページから構成されています：

### 🏠 メインページ: データ読み込み (`streamlit_app.py`)

**役割**: 6種類のCSVファイルをアップロードして、推薦システムの基礎データを準備します。

**アップロードファイル:**
1. **メンバーマスタ** - 従業員情報
2. **力量（スキル）マスタ** - スキル定義
3. **教育マスタ** - 教育・研修情報
4. **資格マスタ** - 資格情報
5. **習得力量** - メンバーの習得スキル情報
6. **カテゴリマスタ** - スキルカテゴリ情報

**使い方:**
1. 左サイドバーから各CSVファイルをドラッグ&ドロップまたは選択
2. 全6種類のファイルをアップロード後、「データ読み込み」ボタンをクリック
3. データ変換処理が実行され、推薦システムで使用可能な形式に変換されます

### 🔗 ページ1: 因果推論推薦 (`pages/1_Causal_Recommendation.py`)

**役割**: 因果推論とベイジアンネットワークを活用して、統計的に説得力のあるスキル推薦を行います。

**主な技術:**
- **LiNGAM**: スキル間の因果構造を発見
- **Bayesian Network**: 確率的推論による習得可能性評価
- **3軸スコアリング**: Readiness（準備度）、Probability（習得確率）、Utility（将来性）

**使い方:**
1. 左サイドバーで推薦対象メンバーを選択
2. 推薦件数（5〜20件）を設定
3. 「推薦実行」ボタンをクリック
4. 推薦結果が3軸スコアとともに表示されます
5. インタラクティブな因果グラフで、スキル間の因果関係を視覚的に確認できます

**推薦結果の見方:**
```
1. Python基礎プログラミング
   📊 総合スコア: 8.5
   ├─ 準備度 (Readiness): 9.2 - 前提スキル習得済み
   ├─ 習得確率 (Probability): 8.5 - 同じパターンの人の85%が習得
   └─ 将来性 (Utility): 7.8 - 5つのスキルへの基礎
```

### 🎯 ページ2: 従業員向けキャリアダッシュボード (`pages/2_Employee_Career_Dashboard.py`)

**役割**: 従業員が自分のキャリアパスを明確に理解し、次のステップを計画できるダッシュボードです。

**主な機能:**

#### 1️⃣ 現状分析 (Current Status)
- 保有スキルとレベルの可視化
- 強みや専門性の把握

#### 2️⃣ 目標設定 (Goal Setting)
- ロールモデル（先輩社員）の選択
- 目標職種の設定
- 現状と目標のギャップ分析

#### 3️⃣ キャリアパス比較 (Career Path Comparison)
- 複数の目標を並列で比較
- それぞれの目標に必要なスキルと学習期間を表示
- 最適なキャリアパスの選択をサポート

#### 4️⃣ スマートロードマップ (Smart Roadmap)
- ガントチャート形式の学習計画
- スキル間の依存関係を考慮した順序付け
- 現実的な時間配分（初級3ヶ月、中級6ヶ月、上級9ヶ月）

**使い方:**

##### A. 単一目標の場合
1. 左サイドバーで自分のメンバーコードを選択
2. 「目標タイプ」で「ロールモデル」または「職種」を選択
3. ロールモデル（先輩社員）または目標職種を選択
4. 「ギャップ分析実行」ボタンをクリック
5. 不足スキルとロードマップが表示されます

##### B. 複数目標を比較する場合
1. 「キャリアパス比較モード」をONに切り替え
2. 比較したい目標を複数選択（例: ロールモデルAとロールモデルB）
3. 「比較実行」ボタンをクリック
4. 各目標に必要なスキル数、学習期間、難易度などが並列表示されます
5. 最適なキャリアパスを選択できます

**ダッシュボードの見方:**

```
📊 現在の保有スキル: 45件
🎯 目標（ロールモデル：山田太郎さん）: 78件
📉 ギャップ（不足スキル）: 33件

🗓️ スマートロードマップ:
├─ Python基礎 (3ヶ月) ─┐
├─ SQL基礎 (3ヶ月)     ├─→ データ分析 (6ヶ月)
└─ 統計学基礎 (3ヶ月) ─┘       └─→ 機械学習 (9ヶ月)
```

## CSVファイルの準備

### 必須ファイル

すべてのCSVファイルはUTF-8エンコーディングで保存してください。

#### 1. メンバーマスタ (members.csv)
```csv
メンバーコード,メンバー名,役職,職能等級
m001,山田太郎,主任,3等級
m002,佐藤花子,課長,4等級
```

#### 2. スキル力量マスタ (skills.csv)
```csv
力量コード,力量名,カテゴリ1,カテゴリ2
s001,Python基礎プログラミング,IT技術,プログラミング
s002,SQL基礎,IT技術,データベース
```

#### 3. 教育マスタ (education.csv)
```csv
力量コード,力量名,カテゴリ1,カテゴリ2
e001,リーダーシップ研修,マネジメント,リーダーシップ
```

#### 4. 資格マスタ (license.csv)
```csv
力量コード,力量名,カテゴリ1,カテゴリ2
l001,基本情報技術者,IT資格,国家資格
```

#### 5. 習得力量 (acquired.csv)
```csv
メンバーコード,力量コード,力量レベル
m001,s001,5
m001,s002,3
m002,s001,4
```

#### 6. カテゴリマスタ (categories.csv)
```csv
力量コード,カテゴリ1,カテゴリ2,カテゴリ3
s001,IT技術,プログラミング,Python
s002,IT技術,データベース,SQL
```

## トラブルシューティング

### Q1: アプリが起動しない

```bash
# 依存関係を再インストール
uv sync

# ポートを変更して起動
uv run streamlit run streamlit_app.py --server.port 8502
```

### Q2: CSVアップロードエラー

- **エンコーディング**: UTF-8で保存されているか確認
- **カラム名**: 正しいカラム名が使われているか確認
- **ファイルサイズ**: 大きすぎるファイルは分割してアップロード
- **BOM**: UTF-8 with BOMではなく、UTF-8（BOMなし）で保存

### Q3: データ読み込みエラー

1. 全6種類のCSVファイルがアップロードされているか確認
2. 各CSVファイルの必須カラムが含まれているか確認
3. エラーメッセージを確認し、該当するファイルを修正

### Q4: 因果グラフが表示されない

因果グラフの構築には十分なデータ量（最低50メンバー×50スキル程度）が必要です。データが少ない場合は表示されないことがあります。

### Q5: ロードマップが作成されない

- 目標が設定されているか確認
- 不足スキルが存在するか確認（すでに全スキル習得済みの場合は表示されません）
- データの読み込みが完了しているか確認

## パフォーマンスTips

### データサイズが大きい場合

- メンバー数が1000人以上の場合、データ読み込みに時間がかかります
- 因果グラフの構築は初回のみ実行され、セッション中は再利用されます

### ブラウザキャッシュ

Streamlitはセッションごとにデータを保持します：
- ページをリロードするとデータが消えます
- 同じデータを使う場合は、リロードせずに使い続けてください

## セキュリティ

### ローカル実行推奨

- **本番環境での公開は推奨しません**
- 機密データを含むため、ローカル実行のみを想定
- 公開する場合は、認証機能の追加を検討してください

### データの扱い

- アップロードされたCSVは一時ディレクトリに保存されます
- ブラウザを閉じると、セッションデータは削除されます
- 個人情報を含むデータは適切に管理してください

## 開発者向け情報

### アプリ構成

```
streamlit_app.py (データ読み込み)
├── データアップロード（サイドバー）
├── データ読み込みボタン
└── データ変換処理

pages/1_Causal_Recommendation.py (因果推論推薦)
├── メンバー選択（サイドバー）
├── 推薦設定（推薦件数）
├── 推薦実行ボタン
├── 推薦結果表示（3軸スコア）
└── 因果グラフ可視化

pages/2_Employee_Career_Dashboard.py (キャリアダッシュボード)
├── メンバー選択（サイドバー）
├── 目標設定（ロールモデル/職種）
├── キャリアパス比較モード
├── ギャップ分析
├── スマートロードマップ（ガントチャート）
└── インタラクティブグラフ
```

### セッション状態

Streamlitは以下の状態を管理しています：

| 状態変数 | 内容 |
|---------|------|
| data_loaded | データ読み込み済みフラグ |
| raw_data | 生データ（アップロードされたCSV） |
| transformed_data | 変換済みデータ（推薦システム用） |
| knowledge_graph | 知識グラフ（スキル間の関係） |
| causal_graph | 因果グラフ（スキル間の因果関係） |
| temp_dir | 一時ディレクトリパス |

### カスタマイズ

各Pythonファイルを編集して、以下をカスタマイズできます：

- UIレイアウト
- デフォルト値（推薦件数、学習期間など）
- 表示項目
- グラフのスタイル
- スコアリングの重み

## 関連ドキュメント

- [ML_TECHNICAL_DETAILS.md](ML_TECHNICAL_DETAILS.md) - 機械学習と因果推論の技術詳細
- [MODELS_TECHNICAL_GUIDE.md](MODELS_TECHNICAL_GUIDE.md) - モデル実装の詳細
- [CODE_STRUCTURE.md](CODE_STRUCTURE.md) - コード構造とモジュール設計
- [QUICKSTART.md](QUICKSTART.md) - クイックスタートガイド
- [BEGINNER_GUIDE.md](BEGINNER_GUIDE.md) - 初心者向けガイド
- [本プロジェクトREADME](../README.md) - プロジェクト全体の概要

## 参考リンク

- [Streamlit公式ドキュメント](https://docs.streamlit.io/)
- [Plotly公式ドキュメント](https://plotly.com/python/)
- [LiNGAM公式ドキュメント](https://lingam.readthedocs.io/)
